{% extends "base.html" %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/cadastro_colaboradores.css' %}">
{% endblock head %}

{% block body %}
<div class="container">

    <!-- Painel esquerdo: formul√°rio -->
    <div class="left-panel">
        <h2>
            {% if editando %}
            Editar Colaborador
            {% else %}
            Cadastrar Colaborador
            {% endif %}
        </h2>


        <form method="POST">
            {% csrf_token %}
            {{ form.non_field_errors }}

            <label for="id_matricula">N√∫mero da Matr√≠cula</label>
            {{ form.matricula }}

            <label for="id_nome">Nome</label>
            {{ form.nome }}

            <label for="id_funcao">Fun√ß√£o</label>
            {{ form.funcao }}

            <label for="id_valor_hora">Valor da Hora (R$)</label>
            {{ form.valor_hora }}

            <label for="id_turno">Turno</label>
            {{ form.turno }}

            <!-- Hor√°rios personalizados (aparecem somente se OUTROS) -->
            <div id="horarios-personalizados">
                <h4>Hor√°rios Personalizados</h4>

                <label for="id_hr_entrada_am">Entrada (Manh√£)</label>
                {{ form.hr_entrada_am }}

                <label for="id_hr_saida_am">Sa√≠da (Manh√£)</label>
                {{ form.hr_saida_am }}

                <label for="id_hr_entrada_pm">Entrada (Tarde)</label>
                {{ form.hr_entrada_pm }}

                <label for="id_hr_saida_pm">Sa√≠da (Tarde)</label>
                {{ form.hr_saida_pm }}
            </div>

            <button type="submit">
                {% if editando %}
                Salvar Altera√ß√µes
                {% else %}
                Cadastrar
                {% endif %}
            </button>

            {% if editando %}
            <a href="{% url 'cadastro_colaborador' %}" class="cancel-edit-btn">Cancelar</a>
            {% endif %}

        </form>
    </div>

    <!-- Painel direito: tabela de colaboradores -->
    <div class="right-panel">
        <h2>Colaboradores Cadastrados</h2>
        {% if colaboradores %}
        <table class="client-table">
            <thead>
                <tr>
                    <th>Matr√≠cula</th>
                    <th>Nome</th>
                    <th>Fun√ß√£o</th>
                    <th>Valor/Hora</th>
                    <th>Turno</th>
                    <th>Editar</th>
                    <th>Excluir</th>
                </tr>
            </thead>
            <tbody>
                {% for colaborador in colaboradores %}
                <tr>
                    <td>{{ colaborador.matricula }}</td>
                    <td>{{ colaborador.nome }}</td>
                    <td>{{ colaborador.funcao }}</td>
                    <td>{{ colaborador.valor_hora }}</td>
                    <td>{{ colaborador.turno }}</td>
                    <td>
                        <a href="{% url 'editar_colaborador' colaborador.pk %}" class="edit-btn">‚úèÔ∏è</a>
                    </td>
                    <td>
                        {% if colaborador.os_count > 0 %}
                        <span class="em-uso">
                            Em uso ({{ colaborador.os_count }})
                        </span>
                        {% else %}
                        <a href="#" class="delete-btn" data-id="{{ colaborador.id }}"
                            data-nome="{{ colaborador.nome }}">
                            üóëÔ∏è
                        </a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>Nenhum colaborador cadastrado.</p>
        {% endif %}
    </div>

</div>

<!-- Modal de exclus√£o -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <p>Tem certeza que deseja excluir: <strong id="modalNome"></strong>?</p>
        <form id="deleteForm" method="POST">
            {% csrf_token %}
            <button type="submit" class="confirm-btn">Sim, excluir</button>
            <button type="button" class="cancel-btn">Cancelar</button>
        </form>
    </div>
</div>

<script src="{% static 'js/cadastro_colaborador.js' %}"></script>

{% endblock %}