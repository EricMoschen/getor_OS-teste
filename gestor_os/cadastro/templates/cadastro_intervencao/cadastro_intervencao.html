{% extends "base.html" %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/cadastro_intervencoes.css' %}">
{% endblock head %}

{% block body %}
<div class="container">

    <div class="left-panel">
        <h2>Cadastro de Interven√ß√µes</h2>

        <form method="POST" id="intervForm">
            {% csrf_token %}
            <input type="hidden" name="intervencao_id" id="intervId">

            <label for="descricaoInput">Descri√ß√£o</label>
            <input type="text" name="descricao" id="descricaoInput" required>

            <div style="display:flex; gap:10px; margin-top:10px;">
                <button type="submit" id="submitBtn">Cadastrar</button>
                <button type="button" id="cancelBtn" style="display:none;">Cancelar</button>
            </div>
        </form>
    </div>

    <div class="right-panel">
        <h2>Interven√ß√µes Cadastradas</h2>

        <div class="table-container">
            {% if intervencoes %}
            <table class="client-table">
                <thead>
                    <tr>
                        <th>C√≥digo</th>
                        <th>Descri√ß√£o</th>
                        <th>Editar</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in intervencoes %}
                    <tr>
                        <td>{{ i.cod_intervencao }}</td>
                        <td>{{ i.descricao }}</td>

                        <td>
                            <a href="#"
                               class="edit-btn"
                               data-id="{{ i.cod_intervencao }}"
                               data-descricao="{{ i.descricao }}">
                                ‚úèÔ∏è
                            </a>
                        </td>

                        <td>
                            {% if i.os_count > 0 %}
                                <span class="em-uso">
                                    Em uso ({{ i.os_count }})
                                </span>
                            {% else %}
                                <a href="#"
                                   class="delete-btn"
                                   data-id="{{ i.cod_intervencao }}"
                                   data-nome="{{ i.descricao }}">
                                    üóëÔ∏è
                                </a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
                <p>Nenhuma interven√ß√£o cadastrada.</p>
            {% endif %}
        </div>
    </div>

</div>

<!-- Modal de exclus√£o -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>

        <p>
            Tem certeza que deseja excluir:
            <strong id="modalNome"></strong>?
        </p>

        <form id="deleteForm" method="POST">
            {% csrf_token %}
            <button type="submit" class="confirm-btn">Sim, excluir</button>
            <button type="button" class="cancel-btn">Cancelar</button>
        </form>
    </div>
</div>

<script src="{% static 'js/cadastro_intervencao.js' %}"></script>
{% endblock %}
